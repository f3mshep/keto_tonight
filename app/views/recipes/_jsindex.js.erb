function init(){
    class RecipeCard{
        constructor(recipe){
            this.title = recipe.title;
            this.image = recipe.image;
            this.commentCount = recipe.comments.length;
            this.recipeURL = "/users/" + recipe.user.id + "/recipes/" + recipe.id;
        }

        cardBuilder(){
            var recipeCard = document.createElement("div")
            
            recipeCard.className ="col-md-4"
            recipeCard.innerHTML = "<%=j render(partial: 'recipe_card_template')%>";
            recipeCard.getElementsByClassName("recipePath")[0].href = this.recipeURL
            recipeCard.getElementsByClassName("recipePath")[1].href = this.recipeURL
            recipeCard.getElementsByClassName("recipeImage")[0].src = this.image
            recipeCard.getElementsByClassName("card-title")[0].innerHTML = this.title
            recipeCard.getElementsByClassName("recipeCommentCount")[0].innerHTML = this.commentCount + ' comments'
            document.getElementsByClassName("row")[0].appendChild(recipeCard)
        }

    }

    function clearRecipeCache(){
        document.getElementsByClassName("row")[0].innerHTML = "";
    }

    function requestRecipes(){
        //rails renders empty page which has AJAX request attached to it which calls the same URL with a JSON request
        let path = window.location.href.replace(/https?:\/\/localhost:3000/, "")
        if(path.includes("commit")){
            path = path + "&request=true"
        }
        else {
            path = path + ".json"
        }

        $.get(path, function(recipes){
            clearRecipeCache()
            for (const recipe of recipes) {
                let card = new RecipeCard(recipe);
                card.cardBuilder()
            }
        })
    }

    $(function(){
        requestRecipes()
    });
}
init()
